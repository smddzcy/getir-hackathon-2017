!function(e,n,o,i){"use strict";(function(){n.module("uiGmapgoogle-maps.providers",["nemLogging"]),n.module("uiGmapgoogle-maps.wrapped",[]),n.module("uiGmapgoogle-maps.extensions",["uiGmapgoogle-maps.wrapped","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api.utils",["uiGmapgoogle-maps.extensions"]),n.module("uiGmapgoogle-maps.directives.api.managers",[]),n.module("uiGmapgoogle-maps.directives.api.options",["uiGmapgoogle-maps.directives.api.utils"]),n.module("uiGmapgoogle-maps.directives.api.options.builders",[]),n.module("uiGmapgoogle-maps.directives.api.models.child",["uiGmapgoogle-maps.directives.api.utils","uiGmapgoogle-maps.directives.api.options","uiGmapgoogle-maps.directives.api.options.builders"]),n.module("uiGmapgoogle-maps.directives.api.models.parent",["uiGmapgoogle-maps.directives.api.managers","uiGmapgoogle-maps.directives.api.models.child","uiGmapgoogle-maps.providers"]),n.module("uiGmapgoogle-maps.directives.api",["uiGmapgoogle-maps.directives.api.models.parent"]),n.module("uiGmapgoogle-maps",["uiGmapgoogle-maps.directives.api","uiGmapgoogle-maps.providers"])}).call(this),n.module("uiGmapgoogle-maps.wrapped").service("uiGmapuuid",function(){function e(){}return e.generate=function(){var n=e._gri,o=e._ha;return o(n(32),8)+"-"+o(n(16),4)+"-"+o(16384|n(12),4)+"-"+o(32768|n(14),4)+"-"+o(n(48),12)},e._gri=function(e){return 0>e?NaN:30>=e?0|Math.random()*(1<<e):53>=e?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<e-30)):NaN},e._ha=function(e,n){for(var o=e.toString(16),i=n-o.length,t="0";0<i;i>>>=1,t+=t)1&i&&(o=t+o);return o},e}),function(){n.module("uiGmapgoogle-maps.providers").factory("uiGmapMapScriptLoader",["$q","uiGmapuuid",function(i,t){var a,r,u,s,l;return s=void 0,l=void 0,a=function(e){return e.china?"http://maps.google.cn/maps/api/js?":"auto"===e.transport?"//maps.googleapis.com/maps/api/js?":e.transport+"://maps.googleapis.com/maps/api/js?"},r=function(e){var n,i,r,u;return n=["transport","isGoogleMapsForWork","china","preventLoad"],e.isGoogleMapsForWork&&n.push("key"),i=o.map(o.omit(e,n),function(e,n){return n+"="+e}),s&&(u=document.getElementById(s),u.parentNode.removeChild(u)),i=i.join("&"),r=document.createElement("script"),r.id=s="ui_gmap_map_load_"+t.generate(),r.type="text/javascript",r.src=a(e)+i,document.head.appendChild(r)},u=function(){return n.isDefined(e.google)&&n.isDefined(e.google.maps)},{load:function(n){var o,t;return o=i.defer(),u()?(o.resolve(e.google.maps),o.promise):(t=n.callback="onGoogleMapsReady"+Math.round(1e3*Math.random()),e[t]=function(){e[t]=null,o.resolve(e.google.maps)},e.navigator.connection&&e.Connection&&e.navigator.connection.type===e.Connection.NONE&&!n.preventLoad?document.addEventListener("online",function(){if(!u())return r(n)}):n.preventLoad||r(n),l=n,l.randomizedFunctionName=t,o.promise)},manualLoad:function(){var n;return n=l,u()?e[n.randomizedFunctionName]?e[n.randomizedFunctionName]():void 0:r(n)}}}]).provider("uiGmapGoogleMapApi",function(){return this.options={transport:"https",isGoogleMapsForWork:!1,china:!1,v:"3",libraries:"",language:"en",preventLoad:!1},this.configure=function(e){n.extend(this.options,e)},this.$get=["uiGmapMapScriptLoader",function(e){return function(n){return n.load(e.options)}}(this)],this}).service("uiGmapGoogleMapApiManualLoader",["uiGmapMapScriptLoader",function(e){return{load:function(){e.manualLoad()}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapLogger",["nemSimpleLogger",function(e){return e.spawn()}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapGmapUtil",["uiGmapLogger","$compile",function(e,i){var t,a,r,u,s,l;return a=function(e,n,o){return e===n||o.indexOf(e)!==-1},t=function(e){return a(e,!1,["false","FALSE",0,"n","N","no","NO"])},u=function(e){return Array.isArray(e)&&2===e.length?e[1]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[1]:e.latitude},s=function(e){return Array.isArray(e)&&2===e.length?e[0]:n.isDefined(e.type)&&"Point"===e.type?e.coordinates[0]:e.longitude},r=function(e){if(e)return e instanceof google.maps.LatLng?e:Array.isArray(e)&&2===e.length?new google.maps.LatLng(e[1],e[0]):n.isDefined(e.type)&&"Point"===e.type?new google.maps.LatLng(e.coordinates[1],e.coordinates[0]):new google.maps.LatLng(e.latitude,e.longitude)},l=function(e){if(n.isUndefined(e))return!1;if(o.isArray(e)){if(2===e.length)return!0}else if(null!=e&&(null!=e?e.type:void 0)&&"Point"===e.type&&o.isArray(e.coordinates)&&2===e.coordinates.length)return!0;return!(!e||!n.isDefined((null!=e?e.latitude:void 0)&&n.isDefined(null!=e?e.longitude:void 0)))},{setCoordsFromEvent:function(e,o){if(e)return Array.isArray(e)&&2===e.length?(e[1]=o.lat(),e[0]=o.lng()):n.isDefined(e.type)&&"Point"===e.type?(e.coordinates[1]=o.lat(),e.coordinates[0]=o.lng()):(e.latitude=o.lat(),e.longitude=o.lng()),e},getLabelPositionPoint:function(e){var n,o;if(void 0!==e)return e=/^([-\d\.]+)\s([-\d\.]+)$/.exec(e),n=parseFloat(e[1]),o=parseFloat(e[2]),null!=n&&null!=o?new google.maps.Point(n,o):void 0},createWindowOptions:function(o,t,a,u){var s;return null!=a&&null!=u&&null!=i?(s=n.extend({},u,{content:this.buildContent(t,u,a),position:null!=u.position?u.position:n.isObject(o)?o.getPosition():r(t.coords)}),null!=o&&null==(null!=s?s.pixelOffset:void 0)&&(null==s.boxClass||(s.pixelOffset={height:0,width:-2})),s):u?u:(e.error("infoWindow defaults not defined"),a?void 0:e.error("infoWindow content not defined"))},buildContent:function(e,n,o){var t,a;return null!=n.content?a=n.content:null!=i?(o=o.replace(/^\s+|\s+$/g,""),t=""===o?"":i(o)(e),t.length>0&&(a=t[0])):a=o,a},defaultDelay:50,isTrue:function(e){return a(e,!0,["true","TRUE",1,"y","Y","yes","YES"])},isFalse:t,isFalsy:function(e){return a(e,!1,[void 0,null])||t(e)},getCoords:r,validateCoords:l,equalCoords:function(e,n){return u(e)===u(n)&&s(e)===s(n)},validatePath:function(e){var i,t,a,r;if(t=0,n.isUndefined(e.type)){if(!Array.isArray(e)||e.length<2)return!1;for(;t<e.length;){if(!(n.isDefined(e[t].latitude)&&n.isDefined(e[t].longitude)||"function"==typeof e[t].lat&&"function"==typeof e[t].lng))return!1;t++}return!0}if(n.isUndefined(e.coordinates))return!1;if("Polygon"===e.type){if(e.coordinates[0].length<4)return!1;i=e.coordinates[0]}else if("MultiPolygon"===e.type){if(r={max:0,index:0},o.forEach(e.coordinates,function(e,n){if(e[0].length>this.max)return this.max=e[0].length,this.index=n},r),a=e.coordinates[r.index],i=a[0],i.length<4)return!1}else{if("LineString"!==e.type)return!1;if(e.coordinates.length<2)return!1;i=e.coordinates}for(;t<i.length;){if(2!==i[t].length)return!1;t++}return!0},convertPathPoints:function(e){var i,t,a,r,u;if(t=0,r=new google.maps.MVCArray,n.isUndefined(e.type))for(;t<e.length;)n.isDefined(e[t].latitude)&&n.isDefined(e[t].longitude)?a=new google.maps.LatLng(e[t].latitude,e[t].longitude):"function"==typeof e[t].lat&&"function"==typeof e[t].lng&&(a=e[t]),r.push(a),t++;else for("Polygon"===e.type?i=e.coordinates[0]:"MultiPolygon"===e.type?(u={max:0,index:0},o.forEach(e.coordinates,function(e,n){if(e[0].length>this.max)return this.max=e[0].length,this.index=n},u),i=e.coordinates[u.index][0]):"LineString"===e.type&&(i=e.coordinates);t<i.length;)r.push(new google.maps.LatLng(i[t][1],i[t][0])),t++;return r},getPath:function(e,n){var i;return null!=n&&o.isString(n)?(i=e,o.each(n.split("."),function(e){if(i)return i=i[e]}),i):n},validateBoundPoints:function(e){return!(n.isUndefined(e.sw.latitude)||n.isUndefined(e.sw.longitude)||n.isUndefined(e.ne.latitude)||n.isUndefined(e.ne.longitude))},convertBoundPoints:function(e){var n;return n=new google.maps.LatLngBounds(new google.maps.LatLng(e.sw.latitude,e.sw.longitude),new google.maps.LatLng(e.ne.latitude,e.ne.longitude))},fitMapBounds:function(e,n){return e.fitBounds(n)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps.directives.api.utils").service("uiGmapEventsHelper",["uiGmapLogger",function(e){var i,t;return t=function(e){return n.isDefined(e.events)&&null!=e.events&&n.isObject(e.events)},i=function(e,n){return t(e)?e:t(n)?n:void 0},{setEvents:function(e,t,a,r){var u;if(u=i(t,a),null!=u)return o.compact(o.map(u.events,function(i,s){var l;if(r&&(l=o(r).includes(s)),u.events.hasOwnProperty(s)&&n.isFunction(u.events[s])&&!l)return google.maps.event.addListener(e,s,function(){return t.$evalAsync||(t.$evalAsync=function(){}),t.$evalAsync(i.apply(t,[e,s,a,arguments]))})}))},removeEvents:function(e){var n,o;if(e)for(n in e)o=e[n],o&&e.hasOwnProperty(n)&&google.maps.event.removeListener(o)}}}])}.call(this),function(){n.module("uiGmapgoogle-maps").directive("uiGmapStreetViewPanorama",["uiGmapGoogleMapApi","uiGmapLogger","uiGmapGmapUtil","uiGmapEventsHelper",function(e,o,i,t){var a;return a="uiGmapStreetViewPanorama",{restrict:"EMA",template:'<div class="angular-google-map-street-view-panorama"></div>',replace:!0,scope:{focalcoord:"=",radius:"=?",events:"=?",options:"=?",control:"=?",povoptions:"=?",imagestatus:"="},link:function(r,u,s){return e.then(function(e){return function(e){var s,l,d,p,g,c,m,f,v,h;return f=void 0,h=void 0,d=!1,c=void 0,m=null,v=null,s=function(){if(t.removeEvents(c),null!=f&&(f.unbind("position"),f.setVisible(!1)),null!=h)return null!=(null!=h?h.setVisible:void 0)&&h.setVisible(!1),h=void 0},g=function(e,o){var i;return i=google.maps.geometry.spherical.computeHeading(e,o),d=!0,r.radius=r.radius||50,v=n.extend({heading:i,zoom:1,pitch:0},r.povoptions||{}),m=m=n.extend({navigationControl:!1,addressControl:!1,linksControl:!1,position:e,pov:v,visible:!0},r.options||{}),d=!1},l=function(){var e;return r.focalcoord?r.radius?(s(),null==h&&(h=new google.maps.StreetViewService),r.events&&(c=t.setEvents(h,r,r)),e=i.getCoords(r.focalcoord),h.getPanoramaByLocation(e,r.radius,function(n,o){var i,t,a;if(null!=r.imagestatus&&(r.imagestatus=o),null!=(null!=(a=r.events)?a.image_status_changed:void 0)&&r.events.image_status_changed(h,"image_status_changed",r,o),"OK"===o)return t=n.location.latLng,g(t,e),i=u[0],f=new google.maps.StreetViewPanorama(i,m)})):void o.error(a+": needs a radius to set the camera view from its focal target."):void o.error(a+": focalCoord needs to be defined")},null!=r.control&&(r.control.getOptions=function(){return m},r.control.getPovOptions=function(){return v},r.control.getGObject=function(){return h},r.control.getGPano=function(){return f}),r.$watch("options",function(e,n){if(e!==n&&e!==m&&!d)return l()}),p=!0,r.$watch("focalcoord",function(e,n){if((e!==n||p)&&null!=e)return p=!1,l()}),r.$on("$destroy",function(){return s()})}}(this))}}}])}.call(this)}(window,angular,_);